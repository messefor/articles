Stanでガンマ回帰

Stanを使ったガンマ回帰（gamma regression）について整理したいと思います。ガンマ分布のパラメタ表記にいくつかバリエーションがあることが手伝って、ガンマ回帰は比較的分かりにくい印象があります。一方で目的変数が正の連続値をとるという設定は活用シーンも多いのではないかと思います。



# ガンマ分布

ガンマ回帰では目的変数の分布にガンマ分布を仮定します。ガンマ分布の確率密度関数は以下です。
$$
aa
$$
$\alpha$は`shape`パラメタ、$\beta$は`rate`パラメタです。確率変数$y$は、正の連続値$(y > 0)$です。wikiによると*「電子部品の寿命分布や通信工学におけるトラフィックの待ち時間分布に応用される」*らしいです。時間は正の連続値ですね。

ガンマ分布は`rate`パラメタの逆数の`scale`パラメタ$\theta$と`shape`パラメタで次のように定義される場合もあります。
$$
where \theta = \frac{1}{\beta}
$$


本投稿では[Stanのドキュメント](https://mc-stan.org/docs/2_24/functions-reference/gamma-distribution.html)のパラメタと一致させるため$\alpha$と$\beta$を使います。

> y ~  **`gamma`**(alpha, beta)



$(1)$のようにガンマ分布は、`shape`パラメタ$\alpha$と`rate`パラメタ$\beta$の２つのパラメタで決定されます。2つのパラメタを変化させて分布をプロットしてみます。



## shape={2, 4, 6, 8}、rate=1





## 

